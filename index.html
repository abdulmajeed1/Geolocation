<!DOCTYPE HTML>
<html>
	<head>
		<title>FlagFinder</title>
		<link rel="stylesheet" href="assets/css/jquery.mobile-1.1.1.min.css" />
		<style>
			/*html { height: 100% }
		  	body { height: 100%; margin: 0; padding: 0 }*/
		 	#map_holder { height: 200px;width: 200px; }
		</style>
		<script type="text/javascript" src="assets/js/cordova-2.0.0.js"></script>
		<script src="assets/js/jquery-1.8.0.min.js"></script>
		<script src="assets/js/jquery.mobile-1.1.1.min.js"></script>
		<script src="http://maps.google.com/maps/api/js?key=AIzaSyCJ7xhp7KwIi_rdp8WTVxja2r5KNvA1uK8&sensor=true"></script>
		<script>
			var pictureSource;   // picture source
   			var destinationType; // sets the format of returned value
   			
			function onBodyLoad() {
				document.addEventListener("deviceready", onDeviceReady, false);
			}

			function onDeviceReady() {
				$( document ).delegate("#coords", "pageinit", function() {
				  	navigator.geolocation.getCurrentPosition(onSuccess, onError, { enableHighAccuracy: true });
				});
				
				$( document ).delegate("#map", "pageinit", function() {
					navigator.geolocation.getCurrentPosition(buildMap, onError, { enableHighAccuracy: true });
				});
				
				$( document ).delegate("#watch", "pageinit", function() {
					navigator.geolocation.watchPosition(onWatch, onError, { timeout: 30000 });
				});
				
				$( document ).delegate("#success", "pageinit", function() {
					alert('Success!');
				});
				
				$( document ).delegate("#camera", "pageinit", function() {
					pictureSource=navigator.camera.PictureSourceType;
        			destinationType=navigator.camera.DestinationType;
				});
			}
			
			function onSuccess(position) {
				$('#coords_holder').html('<p>Latitude: ' + position.coords.latitude + '</p></p>Longitude: ' + position.coords.longitude + '</p><p>Accuracy: ' + position.coords.accuracy + '</p>');
			}
			
			function onWatch(position) {
				$('#watch_holder').html('<p>Latitude: ' + position.coords.latitude + '</p></p>Longitude: ' + position.coords.longitude + '</p><p>Accuracy: ' + position.coords.accuracy + '</p>');
			}
			
			function onError(error) {
				alert('code: '    + error.code    + '\n' +
				'message: ' + error.message + '\n');
			}

			function buildMap(position){
				var myLatlng = new google.maps.LatLng(position.coords.latitude,position.coords.longitude)

				var mapOptions = {
		          center: myLatlng,
		          zoom: 18,
		          mapTypeId: google.maps.MapTypeId.ROADMAP
		        };
		        var map = new google.maps.Map(document.getElementById('map_holder'),mapOptions);

		        var marker = new google.maps.Marker({
			      position: myLatlng,
			      map: map,
			      title:"You"
			  });
			}
			
			 // Called when a photo is successfully retrieved
		    //
		    function onPhotoDataSuccess(imageData) {
		      // Uncomment to view the base64 encoded image data
		      // console.log(imageData);
		
		      // Get image handle
		      //
		      var smallImage = document.getElementById('smallImage');
		
		      // Unhide image elements
		      //
		      smallImage.style.display = 'block';
		
		      // Show the captured photo
		      // The inline CSS rules are used to resize the image
		      //
		      smallImage.src = "data:image/jpeg;base64," + imageData;
		    }
		
		    // A button will call this function
		    //
		    function capturePhoto() {
		      // Take picture using device camera and retrieve image as base64-encoded string
		      navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 50,
		        destinationType: destinationType.DATA_URL });
		    }
		
		
		    // Called if something bad happens.
		    // 
		    function onFail(message) {
		      alert('Failed because: ' + message);
		    }
		</script>
	</head>
	<body onload="onBodyLoad()">
		<!-- Home Page -->
		<div data-role="page">
			<div data-role="header">
				<span id="coordList"></span>
			</div>
			<div data-role="content">	
				<ul data-role="listview">
					<li><a href="#coords" data-transition="slide">Get Coords</a></li>
					<li><a href="#map" data-transition="slide">Map</a></li>
					<li><a href="#watch" data-transition="slide">Watch Position</a></li>
					<li><a href="#camera" data-transition="slide">Camera</a></li>
					<li><a href="#success">Page Test</a></li>
				</ul>
			</div>
		</div>
		<!-- End Home Page -->
		
		<!-- Coordinates Page -->
		<div data-role="page" id="coords">
			<div data-role="header">
				<h1>Coords</h1>
			</div>
			<div data-role="content">	
				<div id="coords_holder"></div>
			</div>
		</div>
		<!-- End Coordinates Page -->
		
		<!-- Map Page -->
		<div data-role="page" id="map">
			<div data-role="header">
				<h1>Map</h1>
			</div>
			<div data-role="content">	
				<div id="map_holder"></div>
			</div>
		</div>
		<!-- End Map Page -->
		
		<!-- Map Page -->
		<div data-role="page" id="watch">
			<div data-role="header">
				<h1>Watch Geo</h1>
			</div>
			<div data-role="content">	
				<div id="watch_holder"></div>
			</div>
		</div>
		<!-- End Map Page -->
		
		<!-- Map Page -->
		<div data-role="page" id="camera">
			<div data-role="header">
				<h1>Camera</h1>
			</div>
			<div data-role="content">	
				<button onclick="capturePhoto();">Capture Photo</button> <br>
    			<img style="display:none;width:60px;height:60px;" id="smallImage" src="" />
			</div>
		</div>
		<!-- End Map Page -->
		
		<!-- Success Page -->
		<div data-role="page" id="success">
			<div data-role="header">
				<h1>Success</h1>
			</div>
			<div data-role="content">	
				<p>Successful Load</p>
			</div>
		</div>
		<!-- End Success Page -->
		
	</body>
</html>